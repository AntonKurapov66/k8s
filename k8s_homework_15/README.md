# Домашнее задание к занятию «Компоненты Kubernetes» - Курапов Антон

## Задание. Необходимо определить требуемые ресурсы

Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

* Необходимо упаковать приложение в чарт для деплоя в разные окружения.
* База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
* Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии.
* Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий.
* Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.


## Решение 1.

### Расчет ресурсов по компонентам
* База данных (PostgreSQL, StatefulSet)
  *  Отказоустойчивость: 3 копии (Primary-Replica).
  *  Запросы: 4 ГБ RAM / 1 CPU на под.
  *  Лимиты: 6 ГБ RAM / 2 CPU.
  *  Storage: PersistentVolume (SSD, 100-500 ГБ).
  *  Итого: 12 ГБ RAM, 3 CPU (3 пода).

* Кеш (Redis Cluster, StatefulSet)
  *  Отказоустойчивость: 3 копии (Sentinel для failover).
  *  Запросы: 4 ГБ RAM / 1 CPU на под.
  *  Лимиты: 5 ГБ RAM / 1.5 CPU.
  *  Storage: PersistentVolume (если нужен AOF, 10-50 ГБ).
  *  Итого: 12 ГБ RAM, 3 CPU (3 пода).

* Фронтенд (Nginx, Deployment)
  *  Запросы: 50 МБ RAM / 0.2 CPU на под.
  *  Лимиты: 100 МБ RAM / 0.5 CPU.
  *  Ingress: балансировка через Ingress-контроллер.
  *  Итого: 250 МБ RAM, 1 CPU (5 подов).

* Бекенд (FastAPI, Node.js, Go, Deployment)
  *  Запросы: 600 МБ RAM / 1 CPU на под.
  *  Лимиты: 1 ГБ RAM / 1.5 CPU.
  *  HPA: масштабирование по CPU & RAM.
  *  Итого: 6 ГБ RAM, 10 CPU (10 подов).

### Мы насчитали для подов:

* CPU: 17 ядер
* RAM: 30.25 ГБ

* Добавим запас:
  * Системные процессы, kubelet, network overlay, daemonset-поды (мониторинг, логирование) → ~2 CPU и 4-6 ГБ RAM на ноду.
  * Резерв под auto-scaling (не запускать поды на пределе) → +10-15%
* Новая оценка:
  * CPU: ~20 ядер
  * RAM: ~35 ГБ

То есть 3 worker-ноды по 8 ядер CPU и 14 ГБ RAM на ноду. Если одна нода отвалится, оставшиеся смогут вытянуть нагрузку.

И минимально: 3 master-ноды, 4 CPU / 8 ГБ RAM (так как кластер не большой).
